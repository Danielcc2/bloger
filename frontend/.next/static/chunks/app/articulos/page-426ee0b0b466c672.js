(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[511],{4429:(e,a,t)=>{Promise.resolve().then(t.bind(t,5064))},5064:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>u});var s=t(5155),r=t(2115),l=t(6077),o=t(6874),n=t.n(o),i=t(5731);let c=[{id:1,title:"Las mejores playas de M\xe9xico",slug:"mejores-playas-mexico",content:"M\xe9xico cuenta con algunas de las mejores playas del mundo. Desde las turquesas aguas de Canc\xfan hasta las tranquilas costas de la Riviera Nayarit, estas son nuestras recomendaciones...",image:null,tags:[{id:1,name:"Playas",slug:"playas"},{id:2,name:"M\xe9xico",slug:"mexico"}],avg_rating:4.5,ratings_count:12,created_at:"2023-11-15T10:30:00Z"},{id:2,title:"Gu\xeda para mochileros en Europa",slug:"guia-mochileros-europa",content:"Viajar por Europa con una mochila es una experiencia inigualable. Aqu\xed te contamos c\xf3mo planificar tu ruta, ahorrar en alojamiento y transporte, y disfrutar al m\xe1ximo de la cultura local...",image:null,tags:[{id:3,name:"Mochileros",slug:"mochileros"},{id:4,name:"Europa",slug:"europa"},{id:5,name:"Presupuesto",slug:"presupuesto"}],avg_rating:4.8,ratings_count:24,created_at:"2023-10-22T15:45:00Z"}],d=[{id:1,name:"Playas",slug:"playas"},{id:2,name:"M\xe9xico",slug:"mexico"},{id:3,name:"Mochileros",slug:"mochileros"},{id:4,name:"Europa",slug:"europa"}];function u(){let[e,a]=(0,r.useState)([]),[t,o]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[h,g]=(0,r.useState)(null),[x,p]=(0,r.useState)([]),[f,j]=(0,r.useState)(""),{user:y}=(0,i.A)(),[v,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(y)try{let e=localStorage.getItem("token"),a=await fetch("http://localhost:8000/api/users/permissions/",{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();b(e.can_create_content||!1)}}catch(e){console.error("Error al comprobar permisos:",e)}})()},[y]),(0,r.useEffect)(()=>{(async()=>{try{m(!0),g(null);let e="http://localhost:8000/api/articles/";if(x.length>0){let a=x.map(e=>"tags=".concat(e)).join("&");e+="?".concat(a)}if(f){let a=e.includes("?")?"&":"?";e+="".concat(a,"search=").concat(f)}console.log("Fetching articles from:",e);let t=await fetch(e);if(!t.ok){console.error("Error en la respuesta de art\xedculos:",t.status,t.statusText);let e=await t.text();throw console.error("Detalles del error:",e),Error("Error al cargar datos: ".concat(t.status))}let s=await t.json();console.log("Articles data:",s),!s.results&&Array.isArray(s)?a(s):a(s.results||[]);try{let e="http://localhost:8000/api/tags/";console.log("Fetching tags from:",e);let a=await fetch(e);if(console.log("Tags response status:",a.status),a.ok){let e=await a.json();console.log("Tags data:",e),!e.results&&Array.isArray(e)?o(e):o(e.results||[])}else{console.error("Error al cargar tags:",a.status);let e=[],t=new Set;(Array.isArray(s)?s:s.results||[]).forEach(a=>{a.tags&&Array.isArray(a.tags)&&a.tags.forEach(a=>{t.has(a.id)||(t.add(a.id),e.push(a))})}),o(e)}}catch(e){console.error("Error al obtener tags:",e),o([])}}catch(t){console.error("Error obteniendo art\xedculos:",t),g("Error al cargar los art\xedculos: ".concat(t instanceof Error?t.message:"Error desconocido")),0===e.length&&a(c)}finally{m(!1)}})()},[x,f,e.length]);let w=e=>{p(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])},N=()=>{p([]),j("")},E=e.length>0?e:c,k=t.length>0?t:d;return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Art\xedculos de Viaje"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Descubre consejos, gu\xedas y destinos para tus pr\xf3ximas aventuras"})]}),y&&v&&(0,s.jsxs)(n(),{href:"/articulos/crear",className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 00-1 1v5H4a1 1 0 100 2h5v5a1 1 0 102 0v-5h5a1 1 0 100-2h-5V4a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Crear art\xedculo"]})]}),h&&(0,s.jsxs)("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6",children:[h,(0,s.jsx)("button",{onClick:()=>g(null),className:"ml-2 text-red-800 hover:underline",children:"Cerrar"})]}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,s.jsx)("div",{className:"md:w-1/4",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md sticky top-24",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Filtros"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-700 mb-2",children:"Buscar"}),(0,s.jsx)("input",{type:"text",value:f,onChange:e=>j(e.target.value),placeholder:"Buscar art\xedculos...",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-1 focus:ring-teal-500"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-700 mb-2",children:"Categor\xedas"}),(0,s.jsx)("div",{className:"space-y-2",children:k.map(e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"tag-".concat(e.slug),checked:x.includes(e.slug),onChange:()=>w(e.slug),className:"mr-2 h-4 w-4 text-teal-600 focus:ring-teal-500"}),(0,s.jsx)("label",{htmlFor:"tag-".concat(e.slug),className:"text-gray-700",children:e.name})]},e.id))})]}),(x.length>0||f)&&(0,s.jsx)("button",{onClick:N,className:"w-full py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Limpiar filtros"})]})}),(0,s.jsx)("div",{className:"md:w-3/4",children:u?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500"})}):h?(0,s.jsx)("div",{className:"bg-red-50 p-4 rounded-lg",children:(0,s.jsx)("p",{className:"text-red-700 mb-4",children:h})}):0===E.length?(0,s.jsxs)("div",{className:"bg-gray-50 p-8 rounded-lg text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"No se encontraron art\xedculos"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Prueba a cambiar los filtros de b\xfasqueda"}),(0,s.jsx)("button",{onClick:N,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Limpiar filtros"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(e=>(0,s.jsx)(l.A,{...e},e.id))})})]})]})}},5695:(e,a,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},5731:(e,a,t)=>{"use strict";t.d(a,{A:()=>n,default:()=>i});var s=t(5155),r=t(2115),l=t(5695);let o=(0,r.createContext)(void 0),n=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth debe ser usado dentro de un AuthProvider");return e};function i(e){let{children:a}=e,[t,n]=(0,r.useState)(null),[i,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0),[m,h]=(0,r.useState)(null),g=(0,l.useRouter)();(0,r.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("token");if(e){c(e);let a=await fetch("http://localhost:8000/api/users/profile/",{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();n(e)}else localStorage.removeItem("token"),c(null),n(null)}}catch(e){console.error("Error verificando sesi\xf3n:",e)}finally{u(!1)}})()},[]);let x=async(e,a)=>{u(!0),h(null);try{let t=await fetch("http://localhost:8000/api/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:a})});if(t.ok){let e=await t.json();localStorage.setItem("token",e.access),localStorage.setItem("refresh_token",e.refresh),c(e.access);let a=await fetch("http://localhost:8000/api/users/profile/",{headers:{Authorization:"Bearer ".concat(e.access)}});if(a.ok){let e=await a.json();return n(e),!0}}else{let e=await t.json();return h(e.detail||"Error al iniciar sesi\xf3n"),!1}}catch(e){h("Error de conexi\xf3n"),console.error(e)}finally{u(!1)}return!1},p=async(e,a,t,s)=>{u(!0),h(null);try{let o={email:e,password:a,...t&&{first_name:t},...s&&{last_name:s}},n=await fetch("http://localhost:8000/api/users/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(n.ok)return await x(e,a);{var r,l;let e=await n.json();return h((null==(r=e.email)?void 0:r[0])||(null==(l=e.password)?void 0:l[0])||"Error al registrarse"),!1}}catch(e){return h("Error de conexi\xf3n"),console.error(e),!1}finally{u(!1)}};return(0,s.jsx)(o.Provider,{value:{user:t,token:i,login:x,register:p,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),c(null),n(null),g.push("/")},isAuthenticated:!!t&&!!i,isLoading:d,error:m},children:a})}},6077:(e,a,t)=>{"use strict";t.d(a,{A:()=>d});var s=t(5155),r=t(6874),l=t.n(r),o=t(6766),n=t(2115);let i=e=>{let a=document.createElement("DIV");return a.innerHTML=e,a.textContent||a.innerText||""},c=async e=>{{let a=window.sessionStorage,t=a.getItem("img_exists_".concat(e));if(null!==t)return"true"===t;try{let t=(await fetch(e,{method:"HEAD"})).ok;return a.setItem("img_exists_".concat(e),t.toString()),t}catch(t){return a.setItem("img_exists_".concat(e),"false"),!1}}},d=e=>{let{title:a,slug:t,content:r,image:d,tags:u,author:m,avg_rating:h,ratings_count:g,created_at:x,is_destination:p=!1,continent:f}=e,[j,y]=(0,n.useState)(null),v=new Date(x).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),b=i(r),w=b.length>150?b.substring(0,150)+"...":b;return(0,n.useEffect)(()=>{(async()=>{try{if(d){let e=d.startsWith("http")?d:d.startsWith("/media/")?"http://localhost:8000".concat(d):"http://localhost:8000/media/".concat(d);console.log("Usando imagen del backend:",e),y(e);return}let e=e=>null==e?"":String(e).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s]/g,""),s=[...e(a).split(/\s+/),...e(t).split(/[-_]/),...u.map(a=>e(a.name))].filter(e=>e.length>3),r=["francia","paris","italia","roma","espa\xf1a","madrid","barcelona","jap\xf3n","japon","tokio","china","tailandia","india","vietnam","alemania","berl\xedn","berlin","grecia","atenas","portugal","lisboa","estados","unidos","nueva","york","mexico","canada","brasil","africa","egipto","marruecos","australia","nueva","zelanda"],l=s.find(e=>r.includes(e));l?(("estados"===l||"unidos"===l)&&(l="usa"),"nueva"===l&&s.includes("york")&&(l="newyork"),"nueva"===l&&s.includes("zelanda")&&(l="nuevazelanda")):l=s.sort((e,a)=>a.length-e.length)[0]||t;let o=[".jpg",".webp"];for(let e of o){let a="/images/destinos/".concat(l).concat(e);if(await c(a))return void y(a)}if(f){let a=e(f);for(let e of o){let t="/images/destinos/".concat(a).concat(e);if(await c(t))return void y(t)}}y("/images/destinos/default.jpg")}catch(e){console.error("Error al determinar la imagen:",e),y("/images/destinos/default.jpg")}})()},[d,t,u,a,f]),(0,s.jsxs)("div",{className:"bg-white rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-shadow",children:[(0,s.jsxs)("div",{className:"relative h-48",children:[j?(0,s.jsx)(o.default,{src:j,alt:a,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"object-cover",onLoad:()=>{},onError:()=>{console.log("Error cargando imagen para: ".concat(a)),"/images/destinos/default.jpg"!==j?y("/images/destinos/default.jpg"):y(null)},priority:!0,loading:"eager"}):(0,s.jsx)("div",{className:"absolute inset-0 bg-teal-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-5xl text-teal-700",children:a.charAt(0).toUpperCase()})}),p&&(0,s.jsx)("div",{className:"absolute top-2 right-2 bg-teal-500 text-white text-xs px-2 py-1 rounded-full",children:"Destino"}),f&&(0,s.jsx)("div",{className:"absolute top-2 left-2 bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:f})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:v}),m&&(0,s.jsxs)("p",{className:"text-gray-600 text-sm",children:["Por ",(0,s.jsx)("span",{className:"font-medium",children:m.display_name||m.email.split("@")[0]})]})]}),(0,s.jsx)("h3",{className:"text-xl font-bold mb-2 text-gray-900",children:(0,s.jsx)(l(),{href:p?"/destinos/".concat(t):"/articulos/".concat(t),className:"hover:text-teal-600 transition-colors",children:a})}),(0,s.jsx)("p",{className:"text-gray-700 mb-4",children:w}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:u.map(e=>(0,s.jsx)(l(),{href:"/categorias/".concat(e.slug),className:"bg-teal-50 text-teal-700 text-xs px-2 py-1 rounded hover:bg-teal-100 transition-colors",children:e.name},e.id))}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{className:"flex items-center",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-yellow-500 mr-1",children:"★"}),(0,s.jsx)("span",{className:"text-gray-700",children:h.toFixed(1)}),(0,s.jsxs)("span",{className:"text-gray-500 text-sm ml-1",children:["(",g," ",1===g?"valoraci\xf3n":"valoraciones",")"]})]}):(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-gray-300 mr-1",children:"★"}),(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:"Nuevo"})]})}),(0,s.jsx)(l(),{href:p?"/destinos/".concat(t):"/articulos/".concat(t),className:"text-teal-600 hover:text-teal-800 font-medium transition-colors",children:p?"Explorar destino →":"Leer m\xe1s →"})]})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[874,766,441,684,358],()=>a(4429)),_N_E=e.O()}]);