(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{3888:(e,t,r)=>{Promise.resolve().then(r.bind(r,8007))},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},5731:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,default:()=>i});var a=r(5155),s=r(2115),l=r(5695);let o=(0,s.createContext)(void 0),n=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth debe ser usado dentro de un AuthProvider");return e};function i(e){let{children:t}=e,[r,n]=(0,s.useState)(null),[i,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),[m,h]=(0,s.useState)(null),p=(0,l.useRouter)();(0,s.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("token");if(e){c(e);let t=await fetch("http://localhost:8000/api/users/profile/",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();n(e)}else localStorage.removeItem("token"),c(null),n(null)}}catch(e){console.error("Error verificando sesi\xf3n:",e)}finally{d(!1)}})()},[]);let f=async(e,t)=>{d(!0),h(null);try{let r=await fetch("http://localhost:8000/api/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(r.ok){let e=await r.json();localStorage.setItem("token",e.access),localStorage.setItem("refresh_token",e.refresh),c(e.access);let t=await fetch("http://localhost:8000/api/users/profile/",{headers:{Authorization:"Bearer ".concat(e.access)}});if(t.ok){let e=await t.json();return n(e),!0}}else{let e=await r.json();return h(e.detail||"Error al iniciar sesi\xf3n"),!1}}catch(e){h("Error de conexi\xf3n"),console.error(e)}finally{d(!1)}return!1},x=async(e,t,r,a)=>{d(!0),h(null);try{let o={email:e,password:t,...r&&{first_name:r},...a&&{last_name:a}},n=await fetch("http://localhost:8000/api/users/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(n.ok)return await f(e,t);{var s,l;let e=await n.json();return h((null==(s=e.email)?void 0:s[0])||(null==(l=e.password)?void 0:l[0])||"Error al registrarse"),!1}}catch(e){return h("Error de conexi\xf3n"),console.error(e),!1}finally{d(!1)}};return(0,a.jsx)(o.Provider,{value:{user:r,token:i,login:f,register:x,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),c(null),n(null),p.push("/")},isAuthenticated:!!r&&!!i,isLoading:u,error:m},children:t})}},8007:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(5155),s=r(2115),l=r(5695),o=r(6874),n=r.n(o),i=r(5731);function c(){let[e,t]=(0,s.useState)(""),[r,o]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[d,m]=(0,s.useState)(!1),h=(0,l.useRouter)(),{login:p,error:f}=(0,i.A)(),x=async t=>{if(t.preventDefault(),!e||!r)return void u("Por favor, completa todos los campos.");m(!0),u("");try{await p(e,r)?h.push("/"):u(f||"Credenciales incorrectas. Por favor, int\xe9ntalo de nuevo.")}catch(e){u("Error al iniciar sesi\xf3n. Por favor, int\xe9ntalo de nuevo m\xe1s tarde."),console.error(e)}finally{m(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Inicia sesi\xf3n en tu cuenta"}),(0,a.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["O"," ",(0,a.jsx)(n(),{href:"/registro",className:"font-medium text-teal-600 hover:text-teal-500",children:"reg\xedstrate si a\xfan no tienes una"})]})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:x,children:[(0,a.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"sr-only",children:"Email"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-teal-500 focus:border-teal-500 focus:z-10 sm:text-sm",placeholder:"Email"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Contrase\xf1a"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:e=>o(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-teal-500 focus:border-teal-500 focus:z-10 sm:text-sm",placeholder:"Contrase\xf1a"})]})]}),c&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:(0,a.jsx)("span",{className:"block sm:inline",children:c})}),(0,a.jsx)("div",{children:(0,a.jsxs)("button",{type:"submit",disabled:d,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 ".concat(d?"opacity-70 cursor-not-allowed":""),children:[d?(0,a.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):(0,a.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-teal-500 group-hover:text-teal-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})}),d?"Iniciando sesi\xf3n...":"Iniciar sesi\xf3n"]})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(n(),{href:"/",className:"font-medium text-teal-600 hover:text-teal-500",children:"Volver a la p\xe1gina de inicio"})})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,441,684,358],()=>t(3888)),_N_E=e.O()}]);