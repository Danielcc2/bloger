(()=>{var e={};e.id=849,e.ids=[849],e.modules={157:(e,r,t)=>{Promise.resolve().then(t.bind(t,3592))},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1452:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=t(5239),o=t(8088),s=t(8170),l=t.n(s),i=t(893),n={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);t.d(r,n);let d={children:["",{children:["articulos",{children:["[slug]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4894)),"/var/www/bloger/frontend/app/articulos/[slug]/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,2007)),"/var/www/bloger/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/var/www/bloger/frontend/app/articulos/[slug]/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/articulos/[slug]/page",pathname:"/articulos/[slug]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2893:(e,r,t)=>{Promise.resolve().then(t.bind(t,4894))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3592:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var a=t(687),o=t(3210),s=t(474),l=t(5814),i=t.n(l),n=t(6189),d=t(1295);function c(){let e=(0,n.useParams)(),r=(0,n.useRouter)(),{user:t,token:l}=(0,d.A)(),[c,m]=(0,o.useState)(null),[u,p]=(0,o.useState)([]),[h,x]=(0,o.useState)(!0),[g,v]=(0,o.useState)(null),[f,b]=(0,o.useState)(0),[w,y]=(0,o.useState)(""),[j,N]=(0,o.useState)(!1),[S,E]=(0,o.useState)(!1),[z,_]=(0,o.useState)(!1),R=Array.isArray(e?.slug)?e.slug[0]:e?.slug,C=e=>new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),P=async e=>{if(!t)return void r.push("/login");try{E(!0);let r=localStorage.getItem("token");if(!r){console.error("No se encontr\xf3 token de autenticaci\xf3n"),v("Por favor, inicia sesi\xf3n nuevamente para valorar");return}console.log("Enviando valoraci\xf3n a:",`http://localhost:8000/api/articles/${R}/rate/`),console.log("Valoraci\xf3n:",e);let t=await fetch(`http://localhost:8000/api/articles/${R}/rate/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({score:e})});console.log("Respuesta del servidor (valoraci\xf3n):",t.status,t.statusText);let a="Error al enviar valoraci\xf3n";try{let r=await t.text();if(console.log("Respuesta de valoraci\xf3n en texto:",r),!t.ok){if(r.trim().startsWith("{")||r.trim().startsWith("["))try{let e=JSON.parse(r);console.error("Detalles del error:",e),a=e.detail||e.message||e.error||a}catch(e){console.error("Error al analizar respuesta JSON:",e)}throw v(a),Error(a)}let o=await fetch(`http://localhost:8000/api/articles/${R}/`);if(o.ok){let e=await o.json();m(e)}b(e),v(null)}catch(e){throw console.error("Error al procesar la respuesta:",e),v(a),Error(a)}}catch(e){console.error("Error:",e),g||v("Error al enviar la valoraci\xf3n. Por favor, intenta de nuevo.")}finally{E(!1)}},k=async e=>{if(e.preventDefault(),!t)return void r.push("/login");if(w.trim())try{N(!0);let e=localStorage.getItem("token");if(!e){console.error("No se encontr\xf3 token de autenticaci\xf3n"),v("Por favor, inicia sesi\xf3n nuevamente para comentar");return}console.log("Enviando comentario a:",`http://localhost:8000/api/articles/${R}/comments/create/`),console.log("Contenido del comentario:",w);let r=await fetch(`http://localhost:8000/api/articles/${R}/comments/create/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({content:w})});console.log("Respuesta del servidor:",r.status,r.statusText);let t="Error al enviar comentario";try{let e,a=await r.text();if(console.log("Respuesta en texto:",a),!r.ok){if(a.trim().startsWith("{")||a.trim().startsWith("["))try{let e=JSON.parse(a);console.error("Detalles del error:",e),t=e.detail||e.message||e.error||t}catch(e){console.error("Error al analizar respuesta JSON:",e)}else console.error("Respuesta no es JSON v\xe1lido:",a);throw v(t),Error(t)}try{e=JSON.parse(a),console.log("Comentario creado:",e)}catch(e){console.error("Error al analizar respuesta JSON del comentario:",e),v("El comentario se envi\xf3 pero hubo un error al procesar la respuesta");return}p(r=>[e,...r]),y(""),v(null)}catch(e){throw console.error("Error al procesar la respuesta del comentario:",e),v(t),Error(t)}}catch(e){console.error("Error al enviar comentario:",e),g||v("Error al enviar el comentario. Por favor, intenta de nuevo.")}finally{N(!1)}},A=c?.image?c.image.startsWith("http")?c.image:c.image.startsWith("/media/")?`http://localhost:8000${c.image}`:`http://localhost:8000/media/${c.image}`:null;return h?(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500"})}):g||!c?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto bg-red-50 p-6 rounded-lg",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"Error"}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:g||"No se encontr\xf3 el art\xedculo solicitado"}),(0,a.jsx)(i(),{href:"/articulos",className:"inline-block px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Volver a art\xedculos"})]})}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[g&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:(0,a.jsxs)("p",{className:"flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),g]})}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)(i(),{href:"/articulos",className:"inline-flex items-center text-teal-600 hover:text-teal-800",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver a art\xedculos"]}),(0,a.jsxs)("div",{className:"my-4 p-2 bg-gray-100 text-xs rounded-lg",children:[(0,a.jsxs)("p",{children:["\xbfUsuario logueado?: ",t?"S\xed":"No"]}),t&&(0,a.jsxs)("p",{children:["ID de usuario: ",t.id]}),t&&(0,a.jsxs)("p",{children:["\xbfEs admin?: ",z?"S\xed":"No"," (Forzado a S\xed para depuraci\xf3n)"]}),c&&(0,a.jsxs)("p",{children:["ID del autor: ",c.author.id]}),(0,a.jsx)("p",{children:"\xbfDeber\xeda mostrar bot\xf3n de eliminar?: S\xed (siempre visible)"})]}),t&&(0,a.jsxs)(i(),{href:`/articulos/${c.slug}/editar-imagenes`,className:"inline-flex items-center text-teal-600 hover:text-teal-800 ml-2",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),"Gestionar im\xe1genes"]})]}),(0,a.jsx)("div",{className:"my-6",children:(0,a.jsxs)("button",{onClick:async()=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este art\xedculo? Esta acci\xf3n no se puede deshacer."))try{let e=localStorage.getItem("token");if(!e)return void r.push("/login");if((await fetch(`http://localhost:8000/api/articles/${c.slug}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})).ok)r.push("/articulos");else throw Error("No se pudo eliminar el art\xedculo")}catch(e){console.error("Error al eliminar:",e),v("Error al eliminar el art\xedculo. Por favor, int\xe9ntalo de nuevo.")}},className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-bold text-lg shadow-md flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"ELIMINAR ESTE ART\xcdCULO"]})}),(0,a.jsxs)("div",{className:"mb-8",style:{backgroundColor:"#f8fafc",padding:"2rem",borderRadius:"1rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:[(0,a.jsx)("h1",{className:"mb-4",style:{fontSize:"2.5rem",fontWeight:"bold",color:"#1a202c",fontFamily:"Helvetica Neue, Arial, sans-serif"},children:c.title}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[(0,a.jsx)("div",{style:{width:"3rem",height:"3rem",borderRadius:"50%",backgroundColor:"#0d9488",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"1.25rem"},children:c.author.first_name?.charAt(0).toUpperCase()||c.author.email.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,a.jsx)("span",{style:{fontSize:"1.125rem",fontWeight:"500"},children:c.author.first_name||c.author.email.split("@")[0]}),(0,a.jsx)("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:C(c.created_at)})]}),(0,a.jsxs)("div",{style:{backgroundColor:"#e2e8f0",padding:"0.5rem 1rem",borderRadius:"9999px",display:"flex",alignItems:"center",fontSize:"0.875rem",color:"#475569"},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"1rem",height:"1rem",marginRight:"0.25rem"},viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),Math.ceil(c.content.replace(/<[^>]*>/g,"").split(/\s+/).length/200)," min de lectura"]}),c.created_at!==c.updated_at&&(0,a.jsxs)("div",{style:{fontSize:"0.875rem",fontStyle:"italic",color:"#64748b"},children:["Actualizado: ",C(c.updated_at)]})]}),(0,a.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},children:c.tags.map(e=>(0,a.jsx)(i(),{href:`/categorias/${e.slug}`,style:{backgroundColor:"#e6fffa",color:"#0d9488",padding:"0.5rem 1rem",borderRadius:"9999px",fontSize:"0.875rem",textDecoration:"none",transition:"all 0.2s",fontWeight:"500"},children:e.name},e.id))})]}),A&&(0,a.jsxs)("div",{style:{marginBottom:"2.5rem",borderRadius:"1rem",overflow:"hidden",position:"relative",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},children:[(0,a.jsx)("div",{style:{position:"relative",height:"500px"},children:(0,a.jsx)(s.default,{src:A,alt:c.title,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 100vw, 800px",style:{objectFit:"cover",borderRadius:"1rem"},priority:!0,onError:e=>{let r=e.target;r.onerror=null,r.style.display="none"}})}),(0,a.jsxs)("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 100%)",padding:"1.5rem",color:"white"},children:[(0,a.jsx)("div",{style:{fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.25rem"},children:"Destino destacado"}),(0,a.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:c.title})]})]}),(0,a.jsx)("div",{className:"prose lg:prose-xl max-w-none article-content",style:{fontFamily:"Georgia, serif",lineHeight:1.8,color:"#2d3748",fontSize:"1.125rem"},children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:c.content.replace(/<!--[\s\S]*?-->/g,"").replace(/children: "Información de depuración"/g,"").replace(/data-[a-zA-Z0-9-]*="[^"]*"/g,"")}})}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg mb-8",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:"\xbfTe ha gustado este art\xedculo?"}),(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:[1,2,3,4,5].map(e=>(0,a.jsx)("button",{onClick:()=>P(e),disabled:S,className:`text-3xl focus:outline-none transition-colors ${(f||0)>=e?"text-yellow-500":"text-gray-300 hover:text-yellow-300"}`,children:"★"},e))}),(0,a.jsx)("div",{className:"text-gray-600",children:c.ratings_count>0?(0,a.jsxs)("p",{children:["Valoraci\xf3n media: ",c.avg_rating?.toFixed(1)," de 5 (",c.ratings_count," ",1===c.ratings_count?"valoraci\xf3n":"valoraciones",")"]}):(0,a.jsx)("p",{children:"S\xe9 el primero en valorar este art\xedculo"})})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Comentarios"}),t?(0,a.jsxs)("form",{onSubmit:k,className:"mb-8",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("textarea",{value:w,onChange:e=>y(e.target.value),placeholder:"Deja tu comentario...",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",rows:4,required:!0})}),g&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg",children:g}),(0,a.jsx)("button",{type:"submit",disabled:j||!w.trim(),className:"px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50",children:j?"Enviando...":"Enviar comentario"})]}):(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-8 text-center",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-2",children:"Para dejar un comentario, necesitas iniciar sesi\xf3n"}),(0,a.jsx)(i(),{href:"/login",className:"inline-block px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",children:"Iniciar sesi\xf3n"})]}),u.length>0?(0,a.jsx)("div",{className:"space-y-6",children:u.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.user.first_name||e.user.email.split("@")[0]}),(0,a.jsx)("span",{className:"text-gray-500 text-sm",children:C(e.created_at)})]}),(0,a.jsx)("p",{className:"text-gray-700",children:e.content})]},e.id))}):(0,a.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-gray-700",children:"No hay comentarios a\xfan. \xa1S\xe9 el primero en comentar!"})})]})]})})}},3873:e=>{"use strict";e.exports=require("path")},4894:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/var/www/bloger/frontend/app/articulos/[slug]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/var/www/bloger/frontend/app/articulos/[slug]/page.tsx","default")},6055:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});var a=t(1658);let o=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[447,110,658,474,581],()=>t(1452));module.exports=a})();